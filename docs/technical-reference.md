# 開発環境パッケージインストーラー 技術リファレンス

## tools.json 構造

### 全体構造

```json
{
  "defaults": { ... },
  "tools": [ ... ],
  "repositories": [ ... ]
}
```

### defaults セクション

```json
{
  "defaults": {
    "sourceRoot": "\\\\server\\share\\packages",
    "localRoot": "C:\\packages",
    "destRoot": "C:\\dev-tools",
    "backupRoot": "C:\\packages\\bk",
    "logRoot": "C:\\dev-tools\\logs",
    "7zPath": "C:\\dev-tools\\7zip\\7z.exe",
    "successCodes": [0, 3010]
  }
}
```

| キー | 型 | 説明 |
|------|------|------|
| `sourceRoot` | string | 共有ディレクトリのルートパス |
| `localRoot` | string | ローカルキャッシュディレクトリ |
| `destRoot` | string | インストール先のデフォルトルート |
| `backupRoot` | string | バックアップ保存先ルート |
| `logRoot` | string | ログファイル出力先 |
| `7zPath` | string | 7z.exe のパス |
| `successCodes` | int[] | インストーラー成功とみなす終了コード |

### tools 配列

#### installer タイプ

```json
{
  "name": "git",
  "type": "installer",
  "source": "git",
  "version": "2.43.0",
  "displayName": "Git",
  "silentArgs": "/VERYSILENT /NORESTART",
  "required": false,
  "skipVersionCheck": false,
  "successCodes": [0, 3010]
}
```

| キー | 必須 | 型 | 説明 |
|------|------|------|------|
| `name` | ○ | string | ツール識別名 |
| `type` | ○ | string | `"installer"` 固定 |
| `source` | ○ | string | sourceRoot からの相対フォルダ名 |
| `version` | △ | string | 期待バージョン（レジストリ比較用） |
| `displayName` | △ | string | レジストリ表示名（部分一致検索用） |
| `silentArgs` | ○ | string | サイレントインストール引数 |
| `required` | - | bool | true: 失敗時に即停止 |
| `skipVersionCheck` | - | bool | true: バージョン確認スキップ |
| `successCodes` | - | int[] | defaults を上書き |

#### extract タイプ

```json
{
  "name": "eclipse",
  "type": "extract",
  "source": "eclipse",
  "destination": "C:\\dev-tools\\eclipse"
}
```

| キー | 必須 | 型 | 説明 |
|------|------|------|------|
| `name` | ○ | string | ツール識別名 |
| `type` | ○ | string | `"extract"` 固定 |
| `source` | ○ | string | sourceRoot からの相対フォルダ名 |
| `destination` | ○ | string | 解凍先ディレクトリ |

#### extract + configCopy タイプ

```json
{
  "name": "sqldeveloper",
  "type": "extract",
  "source": "sqldeveloper",
  "destination": "C:\\dev-tools\\sqldeveloper",
  "configCopy": {
    "source": "connections.xml",
    "destination": "%APPDATA%\\SQL Developer\\system\\connections.xml"
  }
}
```

| キー | 必須 | 型 | 説明 |
|------|------|------|------|
| `configCopy.source` | ○ | string | 共有フォルダ内のファイル名 |
| `configCopy.destination` | ○ | string | コピー先パス（環境変数可） |

#### copy タイプ

```json
{
  "name": "modheader",
  "type": "copy",
  "source": "chrome-plugins",
  "destination": "C:\\dev-tools\\chrome-plugins\\modheader"
}
```

| キー | 必須 | 型 | 説明 |
|------|------|------|------|
| `name` | ○ | string | ツール識別名 |
| `type` | ○ | string | `"copy"` 固定 |
| `source` | ○ | string | sourceRoot からの相対フォルダ名 |
| `destination` | ○ | string | コピー先パス |

### repositories 配列

```json
{
  "repositories": [
    {
      "name": "project-main",
      "url": "https://github.com/org/project-main.git",
      "destination": "C:\\workspace\\project-main"
    }
  ]
}
```

| キー | 必須 | 型 | 説明 |
|------|------|------|------|
| `name` | ○ | string | リポジトリ識別名 |
| `url` | ○ | string | Git リポジトリ URL |
| `destination` | ○ | string | クローン先ディレクトリ |

---

## スクリプト詳細フロー

### Install.bat フロー

```
┌─────────────────────────────────────────────────────────────────┐
│ Install.bat 起動                                                │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 1. UTF-8 設定                                                   │
│    chcp 65001                                                   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 2. 管理者権限チェック                                           │
│    net session >nul 2>&1                                        │
│    → 失敗: "管理者として実行してください" → exit 1              │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 3. 設定ファイル確認                                             │
│    %SCRIPT_DIR%config\tools.json 存在チェック                   │
│    → 不在: エラー表示 → exit 1                                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 4. メニュー表示                                                 │
│    ========================================                     │
│      開発環境セットアップ                                       │
│    ========================================                     │
│    1. インストール + Gitクローン自動実行                        │
│    2. インストールのみ                                          │
│    3. Gitクローンのみ                                           │
│    ----------------------------------------                     │
│    選択してください (1-3):                                      │
└─────────────────────────────────────────────────────────────────┘
                              │
          ┌───────────────────┼───────────────────┐
          ▼                   ▼                   ▼
┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
│ 選択 1          │ │ 選択 2          │ │ 選択 3          │
│ トークン入力    │ │                 │ │ トークン入力    │
│ Main.ps1 実行   │ │ Main.ps1 実行   │ │                 │
│ Clone実行       │ │                 │ │ Clone実行       │
└─────────────────┘ └─────────────────┘ └─────────────────┘
          │                   │                   │
          └───────────────────┼───────────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 5. 完了メッセージ表示                                           │
│    exit 0                                                       │
└─────────────────────────────────────────────────────────────────┘
```

### Main.ps1 フロー

```
┌─────────────────────────────────────────────────────────────────┐
│ Main.ps1 起動 (-ConfigPath パラメータ)                          │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 1. モジュール読み込み                                           │
│    Import-Module Logger.psm1                                    │
│    Import-Module FileManager.psm1                               │
│    Import-Module Extractor.psm1                                 │
│    Import-Module Installer.psm1                                 │
│    Import-Module ConfigCopier.psm1                              │
│    Import-Module FileCopier.psm1                                │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 2. 設定ファイル読み込み                                         │
│    $config = Get-Content | ConvertFrom-Json                     │
│    $defaults = $config.defaults                                 │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 3. ログ初期化                                                   │
│    Initialize-Log -LogRoot $defaults.logRoot                    │
│    → install-yyyyMMdd-HHmmss.log 作成                           │
│    → summary-yyyyMMdd-HHmmss.txt 作成                           │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 4. 共有ディレクトリアクセスチェック                             │
│    Test-ShareAccess -SharePath $defaults.sourceRoot             │
│    → 失敗: FATAL ログ出力 → exit 1                              │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 5. タイムスタンプ生成                                           │
│    $timestamp = Get-Date -Format "yyyyMMdd-HHmmss"              │
│    （全ツールで共通使用）                                       │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 6. ツールループ開始                                             │
│    foreach ($tool in $config.tools) { ... }                     │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
              ┌───────────────────────────────┐
              │ 6.1 共有からファイル情報取得  │
              │ Get-SingleFileFromFolder      │
              │ → 複数ファイル: FAILED        │
              └───────────────────────────────┘
                              │
                              ▼
              ┌───────────────────────────────┐
              │ 6.2 タイプ別処理分岐          │
              │ switch ($tool.type)           │
              └───────────────────────────────┘
                              │
       ┌──────────────────────┼──────────────────────┐
       ▼                      ▼                      ▼
┌──────────────┐       ┌──────────────┐       ┌──────────────┐
│ installer    │       │ extract      │       │ copy         │
│ 処理フロー   │       │ 処理フロー   │       │ 処理フロー   │
│ (後述)       │       │ (後述)       │       │ (後述)       │
└──────────────┘       └──────────────┘       └──────────────┘
       │                      │                      │
       └──────────────────────┼──────────────────────┘
                              ▼
              ┌───────────────────────────────┐
              │ 6.3 結果記録                  │
              │ Add-Result -Status SUCCESS    │
              │           / SKIPPED / FAILED  │
              └───────────────────────────────┘
                              │
                              ▼
              ┌───────────────────────────────┐
              │ 次のツールへ (ループ継続)     │
              └───────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 7. サマリー出力                                                 │
│    Write-Summary                                                │
│    → コンソール + summary-*.txt に結果テーブル出力              │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 8. 終了                                                         │
│    失敗あり: exit 1 / すべて成功: exit 0                        │
└─────────────────────────────────────────────────────────────────┘
```

### installer タイプ処理フロー

```
┌─────────────────────────────────────────────────────────────────┐
│ installer タイプ処理開始                                        │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 1. バージョンチェック（skipVersionCheck=false の場合）          │
│    Get-InstalledVersion -DisplayName $tool.displayName          │
│    ↓                                                            │
│    ┌─ インストール済み ─────────────────────────────────────┐   │
│    │ Test-VersionMatch -InstalledVersion -TargetVersion     │   │
│    │ → 一致: SKIPPED "バージョン一致" → 処理終了            │   │
│    │ → 不一致: インストール続行                             │   │
│    └────────────────────────────────────────────────────────┘   │
│    ┌─ 未インストール ───────────────────────────────────────┐   │
│    │ → インストール続行                                     │   │
│    └────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 2. ハッシュ比較 (共有 vs ローカル)                              │
│    $sourceHash = Get-FileHashSHA256 (共有ファイル)              │
│    $localHash = Get-FileHashSHA256 (ローカルファイル)           │
│    ↓                                                            │
│    ┌─ ローカルなし / ハッシュ不一致 ────────────────────────┐   │
│    │ Backup-File (既存があれば)                             │   │
│    │ Copy-FileWithProgress (共有→ローカル)                  │   │
│    └────────────────────────────────────────────────────────┘   │
│    ┌─ ハッシュ一致 ─────────────────────────────────────────┐   │
│    │ コピーをスキップ（既存ローカルファイル使用）           │   │
│    └────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 3. インストーラー実行                                           │
│    Invoke-SilentInstall -InstallerPath -SilentArgs              │
│                         -SuccessCodes                           │
│    ↓                                                            │
│    ┌─ 成功 (exit code in successCodes) ─────────────────────┐   │
│    │ → SUCCESS                                              │   │
│    └────────────────────────────────────────────────────────┘   │
│    ┌─ 失敗 ─────────────────────────────────────────────────┐   │
│    │ required=true: FATAL → exit 1                          │   │
│    │ required=false: FAILED → 次ツールへ継続                │   │
│    └────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

### extract タイプ処理フロー

```
┌─────────────────────────────────────────────────────────────────┐
│ extract タイプ処理開始                                          │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 1. ハッシュ比較 (共有 vs ローカル)                              │
│    $sourceHash = Get-FileHashSHA256 (共有アーカイブ)            │
│    $localHash = Get-FileHashSHA256 (ローカルアーカイブ)         │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 2. スキップ判定                                                 │
│    ┌─ ハッシュ一致 AND 解凍先存在 ──────────────────────────┐   │
│    │ → SKIPPED "ハッシュ一致"                               │   │
│    └────────────────────────────────────────────────────────┘   │
│    ┌─ ハッシュ一致 AND 解凍先なし ──────────────────────────┐   │
│    │ → WARNING "ハッシュ一致だが解凍先なし。再解凍します"   │   │
│    │ → 解凍処理へ                                           │   │
│    └────────────────────────────────────────────────────────┘   │
│    ┌─ ハッシュ不一致 / ローカルなし ────────────────────────┐   │
│    │ Backup-File (既存アーカイブがあれば)                   │   │
│    │ Copy-FileWithProgress (共有→ローカル)                  │   │
│    │ → 解凍処理へ                                           │   │
│    └────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 3. 解凍処理                                                     │
│    Invoke-Extract -ArchivePath -Destination                     │
│                   -SevenZipPath -BackupRoot -Timestamp          │
│    ↓                                                            │
│    ┌─ 解凍先が既に存在 ─────────────────────────────────────┐   │
│    │ Backup-Directory (7z圧縮 → backupRoot へ移動)          │   │
│    │ 既存ディレクトリ削除                                   │   │
│    └────────────────────────────────────────────────────────┘   │
│    ↓                                                            │
│    7z x archive -o"destination" -y                              │
│    または Expand-Archive (.zip で 7z.exe 未インストール時)      │
│    → 成功: SUCCESS / 失敗: FAILED                               │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 4. configCopy 処理（configCopy 設定がある場合のみ）             │
│    Copy-ConfigFile -SourcePath (共有フォルダ内)                 │
│                    -DestinationPath (環境変数展開)              │
│                    -BackupRoot -Timestamp                       │
│    ↓                                                            │
│    ┌─ コピー先に既存ファイルあり ───────────────────────────┐   │
│    │ backupRoot/timestamp/ にバックアップ                   │   │
│    └────────────────────────────────────────────────────────┘   │
│    ↓                                                            │
│    ファイルコピー実行                                           │
└─────────────────────────────────────────────────────────────────┘
```

### copy タイプ処理フロー

```
┌─────────────────────────────────────────────────────────────────┐
│ copy タイプ処理開始                                             │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 1. Copy-ToolFiles 呼び出し                                      │
│    -SourcePath (共有ファイル/フォルダ)                          │
│    -DestinationPath (コピー先)                                  │
│    -BackupRoot -Timestamp                                       │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 2. ファイル/フォルダ自動判定                                    │
│    $isDirectory = (Get-Item $SourcePath).PSIsContainer          │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 3. コピー先存在チェック & ハッシュ比較（ファイルの場合）        │
│    ┌─ コピー先なし ─────────────────────────────────────────┐   │
│    │ → コピー実行へ                                         │   │
│    └────────────────────────────────────────────────────────┘   │
│    ┌─ コピー先あり（ファイル） ─────────────────────────────┐   │
│    │ $sourceHash = Get-FileHashSHA256 (共有)                │   │
│    │ $destHash = Get-FileHashSHA256 (コピー先)              │   │
│    │ → 一致: SKIPPED "ハッシュ一致"                         │   │
│    │ → 不一致: バックアップ後、コピー実行                   │   │
│    └────────────────────────────────────────────────────────┘   │
│    ┌─ コピー先あり（フォルダ） ─────────────────────────────┐   │
│    │ → バックアップ後、コピー実行                           │   │
│    └────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 4. バックアップ & コピー実行                                    │
│    ┌─ バックアップ ────────────────────────────────────────┐    │
│    │ Move-Item → backupRoot/timestamp/itemName             │    │
│    └───────────────────────────────────────────────────────┘    │
│    ┌─ コピー ──────────────────────────────────────────────┐    │
│    │ フォルダ: Copy-Item -Recurse                          │    │
│    │ ファイル: Copy-Item                                   │    │
│    └───────────────────────────────────────────────────────┘    │
│    → 成功: SUCCESS / 失敗: FAILED                               │
└─────────────────────────────────────────────────────────────────┘
```

### Clone-Repositories.ps1 フロー

```
┌─────────────────────────────────────────────────────────────────┐
│ Clone-Repositories.ps1 起動                                     │
│ -ConfigPath (設定ファイルパス)                                  │
│ -AccessToken (SecureString)                                     │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 1. モジュール読み込み                                           │
│    Import-Module Logger.psm1                                    │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 2. 設定ファイル読み込み & ログ初期化                            │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 3. Git インストール確認                                         │
│    git --version                                                │
│    → 失敗: FATAL "Gitがインストールされていません" → exit 1     │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 4. SecureString → 平文変換                                      │
│    Marshal::SecureStringToBSTR                                  │
│    Marshal::PtrToStringAuto                                     │
│    Marshal::ZeroFreeBSTR (メモリクリア)                         │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 5. リポジトリループ                                             │
│    foreach ($repo in $config.repositories) { ... }              │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
              ┌───────────────────────────────┐
              │ 5.1 クローン先存在チェック    │
              │ → 存在: SKIPPED "既存"        │
              └───────────────────────────────┘
                              │
                              ▼
              ┌───────────────────────────────┐
              │ 5.2 親ディレクトリ作成        │
              └───────────────────────────────┘
                              │
                              ▼
              ┌───────────────────────────────┐
              │ 5.3 URLにトークン埋め込み     │
              │ https://TOKEN@github.com/...  │
              └───────────────────────────────┘
                              │
                              ▼
              ┌───────────────────────────────┐
              │ 5.4 git clone 実行            │
              │ → 成功: SUCCESS               │
              │ → 失敗: FAILED                │
              └───────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 6. トークン変数クリア                                           │
│    $tokenPlainText = $null                                      │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ 7. サマリー出力 & 終了                                          │
│    失敗あり: exit 1 / すべて成功: exit 0                        │
└─────────────────────────────────────────────────────────────────┘
```

---

## モジュール関数一覧

### Logger.psm1

| 関数 | パラメータ | 戻り値 | 説明 |
|------|-----------|--------|------|
| `Initialize-Log` | `-LogRoot` | void | ログ初期化、ファイル作成 |
| `Write-Log` | `-Message`, `-Level`, `-IsSection` | void | ログ出力（コンソール+ファイル） |
| `Write-LogSection` | `-ToolName` | void | セクションヘッダ出力 |
| `Write-LogProgress` | `-Operation`, `-CurrentBytes`, `-TotalBytes` | void | 進行度出力 |
| `Add-Result` | `-ToolName`, `-Type`, `-Status`, `-LocalVersion`, `-SharedVersion`, `-Note` | void | 結果エントリ追加 |
| `Write-Summary` | なし | hashtable | サマリーテーブル出力、集計返却 |

### FileManager.psm1

| 関数 | パラメータ | 戻り値 | 説明 |
|------|-----------|--------|------|
| `Get-FileHashSHA256` | `-FilePath`, `-OperationName` | string/null | SHA256ハッシュ計算 |
| `Copy-FileWithProgress` | `-Source`, `-Destination`, `-OperationName` | bool | 進行度付きコピー |
| `Backup-File` | `-FilePath`, `-BackupRoot`, `-Timestamp` | bool | ファイルをバックアップ |
| `Get-SingleFileFromFolder` | `-FolderPath`, `-ExcludeFile` | hashtable | フォルダから単一ファイル取得 |
| `Test-ShareAccess` | `-SharePath` | bool | 共有アクセス確認 |

### Extractor.psm1

| 関数 | パラメータ | 戻り値 | 説明 |
|------|-----------|--------|------|
| `Invoke-Extract` | `-ArchivePath`, `-Destination`, `-SevenZipPath`, `-BackupRoot`, `-Timestamp` | bool | アーカイブ解凍 |
| `Backup-Directory` | `-DirectoryPath`, `-BackupRoot`, `-Timestamp`, `-SevenZipPath` | bool | ディレクトリを圧縮バックアップ |

### Installer.psm1

| 関数 | パラメータ | 戻り値 | 説明 |
|------|-----------|--------|------|
| `Get-InstalledVersion` | `-DisplayName` | hashtable | レジストリからバージョン取得 |
| `Invoke-SilentInstall` | `-InstallerPath`, `-SilentArgs`, `-SuccessCodes` | hashtable | サイレントインストール実行 |
| `Test-VersionMatch` | `-InstalledVersion`, `-TargetVersion` | bool | バージョン比較 |

### ConfigCopier.psm1

| 関数 | パラメータ | 戻り値 | 説明 |
|------|-----------|--------|------|
| `Copy-ConfigFile` | `-SourcePath`, `-DestinationPath`, `-BackupRoot`, `-Timestamp` | bool | 設定ファイルコピー（環境変数展開） |

### FileCopier.psm1

| 関数 | パラメータ | 戻り値 | 説明 |
|------|-----------|--------|------|
| `Copy-ToolFiles` | `-SourcePath`, `-DestinationPath`, `-BackupRoot`, `-Timestamp` | hashtable | ファイル/フォルダコピー |

---

## バックアップ命名規則

| 対象 | バックアップ先 | 例 |
|------|----------------|-----|
| アーカイブファイル | `backupRoot/timestamp/filename` | `C:\packages\bk\20260203-103000\jdk-17.7z` |
| 解凍先ディレクトリ | `backupRoot/timestamp/dirname-timestamp.7z` | `C:\packages\bk\20260203-103000\eclipse-20260203-103000.7z` |
| コピー対象 | `backupRoot/timestamp/itemname` | `C:\packages\bk\20260203-103000\modheader` |
| 設定ファイル | `backupRoot/timestamp/parentdir_filename` | `C:\packages\bk\20260203-103000\system_connections.xml` |

---

## ログレベルと色

| レベル | 色 | 用途 |
|--------|------|------|
| `INFO` | 白 | 通常情報 |
| `SUCCESS` | 緑 | 処理成功 |
| `SKIPPED` | 黄 | スキップ（問題なし） |
| `WARNING` | 黄 | 警告（継続可能） |
| `ERROR` | 赤 | エラー（処理失敗） |
| `FATAL` | 赤背景+白文字 | 致命的エラー（即停止） |
| セクション | シアン | `===`, `---` 区切り線 |
